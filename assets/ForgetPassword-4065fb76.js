import{k as ee,r as u,Y as te,i as A,u as ne,o as se,j as e,f as oe,c as ae,a as re,b as ie,d as le,T as G,L as ue,Z as X,U as ce,$ as de,s as S}from"./index-e1e442e7.js";import{c as pe}from"./chunk-OCNORRQU-cc7a6969.js";import{u as xe}from"./index-73d7ce4e.js";import{a as fe,g as me,S as k,B as ge}from"./chunk-ZHMYA64R-7ceb03c9.js";import{u as he,F as Ce}from"./chunk-XRMX4GAI-0dba0731.js";import{u as Ie}from"./useDispatch-6c7940ca.js";import{B as N,T as q}from"./chunk-PULVB27S-88503be9.js";import{F as Pe}from"./chunk-KRPLQIP4-a95b5481.js";import{H as je}from"./chunk-7OLJDQMT-64bf1d59.js";import{F as ve,I as ye}from"./chunk-6CVSDS6C-4e442a31.js";var[be,Xe,we,Fe]=pe(),[Ee,Ae]=ee({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),z=s=>s==null?void 0:s.split("");function K(s,i){return(i==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(s)}function Se(s={}){const{autoFocus:i,value:c,defaultValue:l,onChange:p,onComplete:d,placeholder:h="â—‹",manageFocus:x=!0,otp:y=!1,id:b,isDisabled:o,isInvalid:C,type:P="number",mask:B}=s,Z=u.useId(),R=b??`pin-input-${Z}`,a=we(),[M,T]=u.useState(!0),[V,H]=u.useState(-1),[I,f]=xe({defaultValue:z(l)||[],value:z(c),onChange:n=>p==null?void 0:p(n.join(""))});u.useEffect(()=>{if(i){const n=a.first();n&&requestAnimationFrame(()=>{n.node.focus()})}},[a]);const L=u.useCallback(n=>{if(!M||!x)return;const t=a.next(n,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[a,M,x]),j=u.useCallback((n,t,r=!0)=>{const m=[...I];m[t]=n,f(m),n!==""&&m.length===a.count()&&m.every(w=>w!=null&&w!=="")?d==null||d(m.join("")):r&&L(t)},[I,f,L,d,a]),W=u.useCallback(()=>{var n;const t=Array(a.count()).fill("");f(t);const r=a.first();(n=r==null?void 0:r.node)==null||n.focus()},[a,f]),$=u.useCallback((n,t)=>{let r=t;return(n==null?void 0:n.length)>0&&(n[0]===t.charAt(0)?r=t.charAt(1):n[0]===t.charAt(1)&&(r=t.charAt(0))),r},[]);return{getInputProps:u.useCallback(n=>{const{index:t,...r}=n,m=F=>{const g=F.target.value,E=I[t],_=$(E,g);if(_===""){j("",t);return}if(g.length>2){if(K(g,P)){const D=g.split("").filter((Te,Q)=>Q<a.count());f(D),D.length===a.count()&&(d==null||d(D.join("")))}}else K(_,P)&&j(_,t),T(!0)},U=F=>{var g;if(F.key==="Backspace"&&x)if(F.target.value===""){const E=a.prev(t,!1);E&&(j("",t-1,!1),(g=E.node)==null||g.focus(),T(!0))}else T(!1)},w=()=>{H(t)},Y=()=>{H(-1)},J=V===t;return{"aria-label":"Please enter your pin code",inputMode:P==="number"?"numeric":"text",type:B?"password":P==="number"?"tel":"text",...r,id:`${R}-${t}`,disabled:o,"aria-invalid":te(C),onChange:A(r.onChange,m),onKeyDown:A(r.onKeyDown,U),onFocus:A(r.onFocus,w),onBlur:A(r.onBlur,Y),value:I[t]||"",autoComplete:y?"one-time-code":"off",placeholder:J?"":h}},[a,V,$,R,o,B,C,x,d,y,h,j,f,P,I]),id:R,descendants:a,values:I,setValue:j,setValues:f,clear:W}}function ke(s={},i=null){const{getInputProps:c}=Ae(),{index:l,register:p}=Fe();return c({...s,ref:fe(p,i),index:l})}function O(s){const i=ne("PinInput",s),{children:c,...l}=se(s),{descendants:p,...d}=Se(l),h=me(c).map(x=>u.cloneElement(x,{__css:i}));return e.jsx(be,{value:p,children:e.jsx(Ee,{value:d,children:h})})}O.displayName="PinInput";var v=oe(function(i,c){const l=ke(i,c);return e.jsx(ae.input,{...l,className:re("chakra-pin-input",i.className)})});v.displayName="PinInputField";function qe(){const s=he(),i=Ie(),c=ie(),[l,p]=u.useState(""),[d,h]=u.useState(null),x=le(o=>o.auth.resetemail),y=o=>{console.log(o),h(o)},b=async()=>{let o=X.get("otp");if(console.log(o),o===d)try{let C=await ce.post("/user/resetpassword",{data:{email:x,password:l}});i(de()),S(s,C.data,"success"),X.remove("otp"),c("/login")}catch(C){S(s,C.response.data,"error")}else l===""?S(s,"Enter New Password","error"):S(s,"OTP Is Incorrect","error")};return e.jsxs(e.Fragment,{children:[e.jsx(N,{marginTop:["-10px","-20px","-30px","-40px","-40px"]}),e.jsx(Pe,{minH:"92.5vh",align:"center",justify:"center",bg:G("gray.50","gray.800"),children:e.jsxs(k,{spacing:8,mx:"auto",maxW:"lg",py:12,px:6,children:[e.jsxs(k,{align:"center",children:[e.jsx(je,{fontSize:"4xl",children:"Enter New Password"}),e.jsx(q,{fontSize:"lg",color:"gray.600",children:"Please enter the OTP that was sent to your email."})]}),e.jsx(N,{rounded:"lg",bg:G("white","gray.700"),boxShadow:"lg",p:8,children:e.jsxs(k,{spacing:4,children:[e.jsxs(Ce,{id:"password",isRequired:!0,children:[e.jsx(ve,{children:"Enter New Password"}),e.jsx(ye,{value:l,onChange:o=>p(o.target.value),type:"text"})]}),e.jsxs(k,{direction:"row",spacing:10,children:[e.jsxs(O,{otp:!0,onChange:o=>y(o),children:[e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{})]}),e.jsx(ge,{bg:"blue.400",color:"white",bgColor:"rgb(0,0,0)",_hover:{boxShadow:"xl"},onClick:b,children:"Submit"})]}),e.jsxs(N,{justifyContent:"center",alignItems:"center",display:"flex",mt:2,children:["Return to"," ",e.jsx(ue,{to:"/login",children:e.jsx(q,{ml:1,textDecorationLine:"underline",color:"blue.400",children:"login"})})]})]})})]})}),e.jsx(N,{marginTop:["-10px","-20px","-30px","-40px","-40px"]})]})}export{qe as default};
