import{j as t,e as b,s as f,f as S,h as N,a as v,d as z,u as C}from"./index-fc669321.js";import{O as E}from"./OrderSummaryDataSection-e4ad6e9a.js";import{I as i}from"./chunk-6CVSDS6C-0df14b3e.js";import{B as P,T as O}from"./chunk-PULVB27S-f6893945.js";import{F as k}from"./chunk-KRPLQIP4-a41b8135.js";import{u as F}from"./useDispatch-9d9c314f.js";import{u as w}from"./chunk-BFUVSDI7-3d56f874.js";import"./chunk-W7WUSNWJ-132d277b.js";import"./chunk-XRMX4GAI-c938fbe2.js";import"./chunk-R42ZB7PB-42827775.js";import"./index-808488dd.js";function L(e,a){return e===a?e!==0||a!==0||1/e===1/a:e!==e&&a!==a}function _(e,a){if(L(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;const r=Object.keys(e),c=Object.keys(a);if(r.length!==c.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(a,r[s])||!L(e[r[s]],a[r[s]]))return!1;return!0}const T=e=>/\S+@\S+\.\S+/.test(e)?{status:!0}:{status:!1,message:"Please provide a valid email id"},I=e=>{const{firstName:a,lastName:r,addressLine1:c,locality:s,pinCode:m,state:n,country:d,email:p,mobile:y}=e;return!a||!r||!c||!s||!m||!n||!d||!p||!y?{status:!1,message:"Please fill the mandatory details"}:{status:!0}},R=e=>e.length!==6?{status:!1,message:"Please provide 6 digit valid pincode"}:{status:!0},W=e=>e.length!==10?{status:!1,message:"Please provide 10 digit valid mobile number"}:{status:!0},D=({onClick:e})=>t.jsx(t.Fragment,{children:t.jsx(i,{onClick:e,as:"button",type:"submit",h:"60px",bg:"#edf2f7",color:"black",border:"1px solid #cecdce",borderRadius:"50px",w:"100%",fontSize:"17px",mt:"20px",_hover:{borderColor:"black"},children:"Place Order"})}),M=({onClick:e,orderSummary:a})=>t.jsxs(P,{children:[t.jsx(E,{...a}),t.jsx(D,{onClick:e})]}),$=({onChange:e})=>t.jsx(t.Fragment,{children:t.jsxs(P,{children:[t.jsx(O,{fontSize:"20px",fontWeight:600,mb:"20px",children:"Enter your name and address:"}),t.jsxs(k,{flexDirection:"column",gap:"20px",children:[t.jsx(i,{onChange:e,type:"text",name:"firstName",placeholder:"First Name*"}),t.jsx(i,{onChange:e,type:"text",name:"lastName",placeholder:"Last Name*"}),t.jsx(i,{onChange:e,type:"text",name:"addressLine1",placeholder:"Address Line 1*"}),t.jsx(i,{onChange:e,type:"text",name:"addressLine2",placeholder:"Address Line 2"}),t.jsxs(k,{gap:"20px",children:[t.jsx(i,{onChange:e,type:"text",name:"locality",placeholder:"City/Locality*"}),t.jsx(i,{onChange:e,type:"number",name:"pinCode",placeholder:"Pin Code*"})]}),t.jsxs(k,{gap:"20px",children:[t.jsx(i,{onChange:e,type:"text",name:"state",placeholder:"State/Territory*"}),t.jsx(i,{onChange:e,type:"text",name:"country",placeholder:"Country*"})]}),t.jsx(O,{fontSize:"20px",fontWeight:600,mt:"30px",children:"What's your contact information?"}),t.jsx(i,{onChange:e,type:"email",name:"email",placeholder:"Email*"}),t.jsx(i,{onChange:e,type:"number",name:"mobile",placeholder:"Mobile*"})]})]})}),q="/ecom-client/assets/nikeLogoPayment-a71c0662.png",K=async(e,a,r,c,s,m,n,d,p)=>{const y={orderSummary:c,cartProducts:s,shippingDetails:e,paymentDetails:{orderId:a,razorpayOrderId:r.razorpay_order_id,razorpayPaymentId:r.razorpay_payment_id}};try{await b.post("/order/createorder",y,{headers:{Authorization:`Bearer ${m}`}}),f(n,"Order placed successfully","success"),S("cartProducts"),S("orderSummary"),d(N()),p("/")}catch(h){console.log(h)}},U=(e,a,r,c,s,m,n,d)=>{const{firstname:p,lastName:y,mobile:h,email:g}=e,o={key:"rzp_test_EpEUZjh3akkK9N",order_id:a.id,amount:a.amount,currency:a.currency,image:q,name:"Nike Clone",description:"Thanks for purchasing",prefill:{name:`${p} ${y}`,email:g,contact:h},handler:async function(u){try{const{data:x}=await b.post("/api/payment/verify",u);f(m,x.message,"success"),K(e,a.id,u,r,c,s,m,n,d)}catch(x){return console.log(x),{status:!1}}},theme:{color:"#3399cc"}},l=new window.Razorpay(o);l.on("payment.failed",u=>(console.log(u.error),alert("Payment failed, please try again"),{status:!1})),l.open()};function te(){const{orderSummary:e,cartProducts:a}=v(o=>o.cart,_),r=v(o=>o.auth.token),c={firstName:"",lastName:"",addressLine1:"",addressLine2:"",locality:"",pinCode:"",state:"",country:"",email:"",mobile:""},[s,m]=z.useState(c),n=w(),d=F(),p=C(),y=({target:{name:o,value:l}})=>{m({...s,[o]:l})},h=o=>{const l=I(o);if(!l.status)return f(n,l.message,"error"),l.status;const u=T(o.email);if(!u.status)return f(n,u.message,"error"),u.status;const x=R(o.pinCode);if(!x.status)return f(n,x.message,"error"),x.status;const j=W(o.mobile);return j.status?!0:(f(n,j.message,"error"),j.status)},g=async o=>{if(o.preventDefault(),!h(s))return;const{data:l}=await b.post("/api/payment/order",{amount:e.total});U(s,l,e,a,r,n,d,p)};return t.jsx(t.Fragment,{children:t.jsxs(P,{p:"20px",my:"30px",mx:"auto",maxW:"1200px",display:"grid",gap:["40px","40px","40px","10%","10%"],gridTemplateColumns:["100%","100%","100%","55% 35%","60% 30%"],children:[t.jsx($,{onChange:y}),t.jsx(M,{onClick:g,orderSummary:e})]})})}export{te as default};
