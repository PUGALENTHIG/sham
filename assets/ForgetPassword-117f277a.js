import{k as Q,r as u,Y as ee,i as A,u as te,o as ne,j as e,f as se,c as oe,a as ae,b as re,d as ie,T as G,L as le,Z as ue,U as ce,$ as de,a0 as pe}from"./index-f6611686.js";import{u as xe,F as fe,s as S}from"./extraFunctions-c2b2dd3a.js";import{c as me}from"./chunk-OCNORRQU-83090bfc.js";import{u as ge}from"./index-871174ea.js";import{a as he,g as Ce,S as k,B as Ie}from"./chunk-ZHMYA64R-676e1919.js";import{u as Pe}from"./useDispatch-8a1563e7.js";import{B as N,T as X}from"./chunk-PULVB27S-f48fad25.js";import{F as je}from"./chunk-KRPLQIP4-87dacf27.js";import{H as ve}from"./chunk-7OLJDQMT-79b2d2a0.js";import{F as ye,I as be}from"./chunk-6CVSDS6C-883f44bc.js";var[we,qe,Fe,Ee]=me(),[Ae,Se]=Q({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),q=s=>s==null?void 0:s.split("");function z(s,r){return(r==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(s)}function ke(s={}){const{autoFocus:r,value:c,defaultValue:i,onChange:p,onComplete:d,placeholder:h="â—‹",manageFocus:x=!0,otp:y=!1,id:b,isDisabled:l,isInvalid:C,type:P="number",mask:B}=s,O=u.useId(),R=b??`pin-input-${O}`,o=Fe(),[M,T]=u.useState(!0),[V,H]=u.useState(-1),[I,f]=ge({defaultValue:q(i)||[],value:q(c),onChange:n=>p==null?void 0:p(n.join(""))});u.useEffect(()=>{if(r){const n=o.first();n&&requestAnimationFrame(()=>{n.node.focus()})}},[o]);const L=u.useCallback(n=>{if(!M||!x)return;const t=o.next(n,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[o,M,x]),j=u.useCallback((n,t,a=!0)=>{const m=[...I];m[t]=n,f(m),n!==""&&m.length===o.count()&&m.every(w=>w!=null&&w!=="")?d==null||d(m.join("")):a&&L(t)},[I,f,L,d,o]),Z=u.useCallback(()=>{var n;const t=Array(o.count()).fill("");f(t);const a=o.first();(n=a==null?void 0:a.node)==null||n.focus()},[o,f]),$=u.useCallback((n,t)=>{let a=t;return(n==null?void 0:n.length)>0&&(n[0]===t.charAt(0)?a=t.charAt(1):n[0]===t.charAt(1)&&(a=t.charAt(0))),a},[]);return{getInputProps:u.useCallback(n=>{const{index:t,...a}=n,m=F=>{const g=F.target.value,E=I[t],_=$(E,g);if(_===""){j("",t);return}if(g.length>2){if(z(g,P)){const D=g.split("").filter((_e,J)=>J<o.count());f(D),D.length===o.count()&&(d==null||d(D.join("")))}}else z(_,P)&&j(_,t),T(!0)},U=F=>{var g;if(F.key==="Backspace"&&x)if(F.target.value===""){const E=o.prev(t,!1);E&&(j("",t-1,!1),(g=E.node)==null||g.focus(),T(!0))}else T(!1)},w=()=>{H(t)},W=()=>{H(-1)},Y=V===t;return{"aria-label":"Please enter your pin code",inputMode:P==="number"?"numeric":"text",type:B?"password":P==="number"?"tel":"text",...a,id:`${R}-${t}`,disabled:l,"aria-invalid":ee(C),onChange:A(a.onChange,m),onKeyDown:A(a.onKeyDown,U),onFocus:A(a.onFocus,w),onBlur:A(a.onBlur,W),value:I[t]||"",autoComplete:y?"one-time-code":"off",placeholder:Y?"":h}},[o,V,$,R,l,B,C,x,d,y,h,j,f,P,I]),id:R,descendants:o,values:I,setValue:j,setValues:f,clear:Z}}function Ne(s={},r=null){const{getInputProps:c}=Se(),{index:i,register:p}=Ee();return c({...s,ref:he(p,r),index:i})}function K(s){const r=te("PinInput",s),{children:c,...i}=ne(s),{descendants:p,...d}=ke(i),h=Ce(c).map(x=>u.cloneElement(x,{__css:r}));return e.jsx(we,{value:p,children:e.jsx(Ae,{value:d,children:h})})}K.displayName="PinInput";var v=se(function(r,c){const i=Ne(r,c);return e.jsx(oe.input,{...i,className:ae("chakra-pin-input",r.className)})});v.displayName="PinInputField";function ze(){const s=xe(),r=Pe(),c=re(),[i,p]=u.useState(""),[d,h]=u.useState(null),x=ie(l=>l.auth.resetemail),y=l=>{console.log(l),h(l)},b=async()=>{if(ue("otp")===d)try{let C=await ce.post("/auth/resetpassword",{data:{email:x,password:i}});r(de()),S(s,C.data,"success"),pe.remove("otp"),c("/login")}catch(C){S(s,C.response.data,"error")}else i===""?S(s,"Enter New Password","error"):S(s,"OTP Is Incorrect","error")};return e.jsxs(e.Fragment,{children:[e.jsx(N,{marginTop:["-10px","-20px","-30px","-40px","-40px"]}),e.jsx(je,{minH:"92.5vh",align:"center",justify:"center",bg:G("gray.50","gray.800"),children:e.jsxs(k,{spacing:8,mx:"auto",maxW:"lg",py:12,px:6,children:[e.jsxs(k,{align:"center",children:[e.jsx(ve,{fontSize:"4xl",children:"Enter New Password"}),e.jsx(X,{fontSize:"lg",color:"gray.600",children:"Please enter the OTP that was sent to your email."})]}),e.jsx(N,{rounded:"lg",bg:G("white","gray.700"),boxShadow:"lg",p:8,children:e.jsxs(k,{spacing:4,children:[e.jsxs(fe,{id:"password",isRequired:!0,children:[e.jsx(ye,{children:"Enter New Password"}),e.jsx(be,{value:i,onChange:l=>p(l.target.value),type:"text"})]}),e.jsxs(k,{direction:"row",spacing:10,children:[e.jsxs(K,{otp:!0,onChange:l=>y(l),children:[e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{})]}),e.jsx(Ie,{bg:"blue.400",color:"white",bgColor:"rgb(0,0,0)",_hover:{boxShadow:"xl"},onClick:b,children:"Submit"})]}),e.jsxs(N,{justifyContent:"center",alignItems:"center",display:"flex",mt:2,children:["Return to"," ",e.jsx(le,{to:"/login",children:e.jsx(X,{ml:1,textDecorationLine:"underline",color:"blue.400",children:"login"})})]})]})})]})}),e.jsx(N,{marginTop:["-10px","-20px","-30px","-40px","-40px"]})]})}export{ze as default};
