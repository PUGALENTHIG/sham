import{l as Y,d as l,y as ee,x as S,F as te,p as ne,j as e,m as se,q as oe,v as ae,u as re,a as ie,a0 as G,L as le,a4 as ue,h as ce,a5 as pe,s as A,a6 as de}from"./index-0d654f4d.js";import{c as me}from"./chunk-OCNORRQU-b33e3014.js";import{u as xe}from"./index-5afac047.js";import{m as fe}from"./index-36eb0af8.js";import{g as ge,S as N}from"./chunk-ZHMYA64R-c747acda.js";import{u as he}from"./chunk-BFUVSDI7-962d7b2c.js";import{u as Ce}from"./useDispatch-6b8094c4.js";import{B as k,T as U}from"./chunk-PULVB27S-eac7c826.js";import{F as Ie}from"./chunk-KRPLQIP4-504e86b3.js";import{H as Pe}from"./chunk-7OLJDQMT-dcbb1898.js";import{F as je}from"./chunk-R42ZB7PB-0065ade7.js";import{F as ve}from"./chunk-7COXQURZ-00f31d58.js";import{I as ye}from"./chunk-6CVSDS6C-fe0866c2.js";import{B as be}from"./chunk-UVUR7MCU-d8bdb95c.js";import"./chunk-XRMX4GAI-3b11bbf6.js";var[we,Ze,Fe,Ee]=me(),[Se,Ae]=Y({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),X=s=>s==null?void 0:s.split("");function z(s,r){return(r==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(s)}function Ne(s={}){const{autoFocus:r,value:c,defaultValue:i,onChange:d,onComplete:p,placeholder:C="â—‹",manageFocus:m=!0,otp:y=!1,id:b,isDisabled:u,isInvalid:x,type:P="number",mask:B}=s,W=l.useId(),R=b??`pin-input-${W}`,o=Fe(),[M,_]=l.useState(!0),[V,H]=l.useState(-1),[I,f]=xe({defaultValue:X(i)||[],value:X(c),onChange:n=>d==null?void 0:d(n.join(""))});l.useEffect(()=>{if(r){const n=o.first();n&&requestAnimationFrame(()=>{n.node.focus()})}},[o]);const L=l.useCallback(n=>{if(!M||!m)return;const t=o.next(n,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[o,M,m]),j=l.useCallback((n,t,a=!0)=>{const g=[...I];g[t]=n,f(g),n!==""&&g.length===o.count()&&g.every(w=>w!=null&&w!=="")?p==null||p(g.join("")):a&&L(t)},[I,f,L,p,o]),O=l.useCallback(()=>{var n;const t=Array(o.count()).fill("");f(t);const a=o.first();(n=a==null?void 0:a.node)==null||n.focus()},[o,f]),$=l.useCallback((n,t)=>{let a=t;return(n==null?void 0:n.length)>0&&(n[0]===t.charAt(0)?a=t.charAt(1):n[0]===t.charAt(1)&&(a=t.charAt(0))),a},[]);return{getInputProps:l.useCallback(n=>{const{index:t,...a}=n,g=F=>{const h=F.target.value,E=I[t],D=$(E,h);if(D===""){j("",t);return}if(h.length>2){if(z(h,P)){const T=h.split("").filter((De,Q)=>Q<o.count());f(T),T.length===o.count()&&(p==null||p(T.join("")))}}else z(D,P)&&j(D,t),_(!0)},q=F=>{var h;if(F.key==="Backspace"&&m)if(F.target.value===""){const E=o.prev(t,!1);E&&(j("",t-1,!1),(h=E.node)==null||h.focus(),_(!0))}else _(!1)},w=()=>{H(t)},Z=()=>{H(-1)},J=V===t;return{"aria-label":"Please enter your pin code",inputMode:P==="number"?"numeric":"text",type:B?"password":P==="number"?"tel":"text",...a,id:`${R}-${t}`,disabled:u,"aria-invalid":ee(x),onChange:S(a.onChange,g),onKeyDown:S(a.onKeyDown,q),onFocus:S(a.onFocus,w),onBlur:S(a.onBlur,Z),value:I[t]||"",autoComplete:y?"one-time-code":"off",placeholder:J?"":C}},[o,V,$,R,u,B,x,m,p,y,C,j,f,P,I]),id:R,descendants:o,values:I,setValue:j,setValues:f,clear:O}}function ke(s={},r=null){const{getInputProps:c}=Ae(),{index:i,register:d}=Ee();return c({...s,ref:fe(d,r),index:i})}function K(s){const r=te("PinInput",s),{children:c,...i}=ne(s),{descendants:d,...p}=Ne(i),C=ge(c).map(m=>l.cloneElement(m,{__css:r}));return e.jsx(we,{value:d,children:e.jsx(Se,{value:p,children:C})})}K.displayName="PinInput";var v=se(function(r,c){const i=ke(r,c);return e.jsx(oe.input,{...i,className:ae("chakra-pin-input",r.className)})});v.displayName="PinInputField";function Je(){const s=he(),r=Ce(),c=re(),[i,d]=l.useState(""),[p,C]=l.useState(null),m=ie(u=>u.auth.resetemail),y=u=>{C(u)},b=async()=>{if(ue("otp")===p)try{let x=await ce.post("/auth/resetpassword",{data:{email:m,password:i}});r(pe()),A(s,x.data,"success"),de.remove("otp"),c("/login")}catch(x){A(s,x.response.data.message?x.response.data.message:"Something Went Wrong","error")}else i===""?A(s,"Enter New Password","error"):A(s,"OTP Is Incorrect","error")};return e.jsxs(e.Fragment,{children:[e.jsx(k,{marginTop:["-10px","-20px","-30px","-40px","-40px"]}),e.jsx(Ie,{minH:"92.5vh",align:"center",justify:"center",bg:G("gray.50","gray.800"),children:e.jsxs(N,{spacing:8,mx:"auto",maxW:"lg",py:12,px:6,children:[e.jsxs(N,{align:"center",children:[e.jsx(Pe,{fontSize:"4xl",children:"Enter New Password"}),e.jsx(U,{fontSize:"lg",color:"gray.600",children:"Please enter the OTP that was sent to your email."})]}),e.jsx(k,{rounded:"lg",bg:G("white","gray.700"),boxShadow:"lg",p:8,children:e.jsxs(N,{spacing:4,children:[e.jsxs(je,{id:"password",isRequired:!0,children:[e.jsx(ve,{children:"Enter New Password"}),e.jsx(ye,{value:i,onChange:u=>d(u.target.value),type:"text"})]}),e.jsxs(N,{direction:"row",spacing:10,children:[e.jsxs(K,{otp:!0,onChange:u=>y(u),children:[e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{})]}),e.jsx(be,{bg:"blue.400",color:"white",bgColor:"rgb(0,0,0)",_hover:{boxShadow:"xl"},onClick:b,children:"Submit"})]}),e.jsxs(k,{justifyContent:"center",alignItems:"center",display:"flex",mt:2,children:["Return to"," ",e.jsx(le,{to:"/login",children:e.jsx(U,{ml:1,textDecorationLine:"underline",color:"blue.400",children:"login"})})]})]})})]})}),e.jsx(k,{marginTop:["-10px","-20px","-30px","-40px","-40px"]})]})}export{Je as default};
